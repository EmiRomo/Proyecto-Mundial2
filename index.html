<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  </head>
  <style>
  body, html {
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: #1e3d4f;
    color: white;
    width: 100%;
    height: 100%;
  }
  #intro {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #1e3d4f;
    z-index: 10;
  }
  #startBtn {
    margin-top: 20px;
    padding: 12px 24px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    background: #00bfff;
    color: white;
    cursor: pointer;
  }
  #startBtn:hover { background: #0099cc; }

  #ar-container {
    width: 100vw;
    height: 100vh;
    background: black;
    position: fixed;
    top: 0; left: 0;
    opacity: 0;
    transition: opacity 0.6s ease;
    z-index: 1;
  }
  #ar-container.active {
    opacity: 1;
  }

  #buttons-panel {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: none;
    gap: 10px;
    z-index: 20;
  }

  #buttons-panel button {
    padding: 10px 20px;
    font-size: 16px;
    border: none;
    border-radius: 6px;
    background: #00bfff;
    color: white;
    cursor: pointer;
  }

  #buttons-panel button:hover {background: #0099cc;}

  #statsBox, #triviaBox {
    position: absolute;
    top: 15%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.8);
    padding: 20px;
    border-radius: 8px;
    display: none;
    z-index: 25;
    max-width: 300px;
    text-align: center;
  }

  #triviaBox button {
    display: block;
    margin: 8px auto;
    padding: 8px 16px;
    font-size: 14px;
  }

</style>

<body>
<div id="intro">
  <h1>Bienvenido a la Experiencia RA</h1>
  <p>Escanea las banderas para descubrir modelos, videos, trivias y estad√≠sticas.</p>
  <button id="startBtn">Activar C√°mara RA</button>
</div>

<div id="ar-container">
  <a-scene mindar-image="imageTargetSrc:./assets/targets/targets.mind" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
    
    <a-assets>
      <!--VIDEOS-->
      <video id="video1" src="assets/videos/argentina.mp4" loop crossorigin="anonymous"webkit-playsinline playsinline ></video>
      <video id="video2" src="assets/videos/brasil.mp4" loop crossorigin="anonymous" webkit-playsinline playsinline ></video>

      <!--MODELOS-->
      <a-asset-item id="model1" src="assets/modelos/mask/scene.gltf"></a-asset-item>

    </a-assets>

    <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

    <!-- Targets -->
    <a-entity mindar-image-target="targetIndex: 0">
      <a-video id="videoPlane" src="#video2" width="1.6" height="0.9" position="0 0 0" visible="false"></a-video>
      <a-gltf-model id="model1" src="#model1" rotation="0 0 0 " position="0 0 0.1" scale="0.005 0.005 0.005"
       visible="false"></a-gltf-model>
    </a-entity>

    <a-entity mindar-image-target="targetIndex: 1">
      <a-video id="videoPlane" src="#video1" width="1.6" height="0.9" position="0 0 0" visible="false"></a-video>
      <a-gltf-model id="model1" src="#model1" rotation="0 0 0 " position="0 0 0.1" scale="0.005 0.005 0.005"
       visible="false"></a-gltf-model>
    </a-entity>

    <a-entity mindar-image-target="targetIndex: 2">
      <a-video id="videoPlane" src="#video2" width="1.6" height="0.9" position="0 0 0" visible="false"></a-video>
      <a-gltf-model id="model1" src="#model1" rotation="0 0 0 " position="0 0 0.1" scale="0.005 0.005 0.005"
       visible="false"></a-gltf-model>
    </a-entity>

    <a-entity mindar-image-target="targetIndex: 3">
      <a-video id="videoPlane" src="#video2" width="1.6" height="0.9" position="0 0 0" visible="false"></a-video>
      <a-gltf-model id="model1" src="#model1" rotation="0 0 0 " position="0 0 0.1" scale="0.005 0.005 0.005"
       visible="false"></a-gltf-model>
    </a-entity>
    
  </a-scene>
</div>

<div id="buttons-panel">
  <button id="btnStats">Estad√≠sticas</button>
  <button id="btnVideo">Video</button>
  <button id="btnTrivia">Trivia</button>
  <button id="btnModel">Modelo</button>
</div>

<div id="statsBox">
  <h3>üìä Estad√≠sticas</h3>
  <p>Pa√≠s: Argentina</p>
  <p>Mundiales Ganados: 3</p>
  <p>Jugador Estrella: Messi</p>
</div>

<div id="triviaBox">
  <h3>‚ùì Trivia</h3>
  <p>¬øCu√°ntos mundiales ha ganado Brasil?</p>
  <button onclick="checkAnswer(3)">3</button>
  <button onclick="checkAnswer(5)">5</button>
  <button onclick="checkAnswer(7)">7</button>
  <p id="triviaResult"></p>
</div>

<script>
  const startBtn = document.getElementById("startBtn");
  const intro = document.getElementById("intro");
  const arContainer = document.getElementById("ar-container");
  const buttonsPanel = document.getElementById("buttons-panel");

  const statsBox = document.getElementById("statsBox");
  const triviaBox = document.getElementById("triviaBox");
  const triviaResult = document.getElementById("triviaResult");

  const videoPlane = document.getElementById("videoPlane");
  const video1 = document.getElementById("video1");
  const modelEntity = document.getElementById("modelEntity");

  startBtn.addEventListener("click", () => {
    intro.style.display = "none";
    arContainer.classList.add("active");

    setTimeout(() => {window.dispatchEvent(new Event("resize"));}, 300);  
  });


  const targets = document.querySelectorAll("[mindar-image-target]");
    targets.forEach(target => {
      target.addEventListener("targetFound", () => {
        console.log("üéØ Bandera detectada");
        buttonsPanel.style.display = "flex";
      });

      target.addEventListener("targetLost", () => {
        console.log("‚ùå Bandera perdida");
        buttonsPanel.style.display = "none";
        statsBox.style.display = "none";
        triviaBox.style.display = "none";

        // Ocultar y pausar
        videoPlane.setAttribute("visible", "false");
        video1.pause();
        video1.currentTime = 0; // Reinicia
        modelEntity.setAttribute("visible", "false");
      });
  });

     // Estadisticas
    document.getElementById("btnStats").addEventListener("click", () => {
      statsBox.style.display = statsBox.style.display === "block" ? "none" : "block";
      triviaBox.style.display = "none";
    });

    // Video
    document.getElementById("btnVideo").addEventListener("click", () => {
      videoPlane.setAttribute("visible", "true");   

      video1.currentTime = 0;
      video1.muted = false;
      
      video1.play().catch(err => console.log("‚ö†Ô∏è Error reproduciendo video:", err));
    });

    // Trivia
    document.getElementById("btnTrivia").addEventListener("click", () => {
      triviaBox.style.display = triviaBox.style.display === "block" ? "none" : "block";
      statsBox.style.display = "none";
    });

    // Modelo
    document.getElementById("btnModel").addEventListener("click", () => {
      const isVisible = modelEntity.getAttribute("visible");
      modelEntity.setAttribute("visible", !isVisible);
      if (!isVisible) {
        modelEntity.setAttribute("animation", {
          property: "rotation",
          to: "0 360 0",
          loop: true,
          dur: 4000,
          easing: "linear"
        });
      } else {
        modelEntity.removeAttribute("animation");
      }
    });

    // Trivia check
    function checkAnswer(ans) {
      if (ans === 5) {
        triviaResult.textContent = "‚úÖ Correcto!";
        triviaResult.style.color = "lightgreen";
      } else {
        triviaResult.textContent = "‚ùå Incorrecto";
        triviaResult.style.color = "red";
      }
    }

</script>

</html>



